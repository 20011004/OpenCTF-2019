#!/usr/bin/env python2
from Crypto.PublicKey import RSA
from Crypto.Util.number import bytes_to_long, long_to_bytes

with open('public.key','rb') as f:
    pubkey = RSA.importKey(f.read())

with open('flag.enc','rb') as f:
    ct = bytes_to_long(f.read())

n = pubkey.n
e = pubkey.e
pt = long_to_bytes(long("""
1355220117725492702506322897281662014851794879885128721989382051113198
7678453218585282215854443992058410527373015010704170142175908900343294
5167015311154000879728282704924116372244690150790845521941246678265857
5327757875008618407061561539478597345843229515195567363298272112515705
7835096743207995851034940085972629889056732771459696384953213002037762
9778404045836420080833206101802765043229899333039974324073187922954731
5498162566277235070795316962035253231305091216813577292795184271180530
0029124117665168106014657485854279805581138700421670760873512636896736
35277351591233486231002104294656154740594638595325194""".replace("\n", "")))



print "[*] n : {}".format(n)
print "[*] e : {}".format(e)
print "[*] ct : {}".format(ct)
print "[+] flag: {}".format(pt[203:])
