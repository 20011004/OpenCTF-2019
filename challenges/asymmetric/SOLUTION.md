# Asymmetric Solution
*by Javantea*  
July 23, 2019

ciphertext.txt contains se, iv, ciphertext, e, and n.
```
b'\x1d\xf6\x1f\x85NAs\x01L\xd7\xdb\xef\xc9\xe6f\x84p-\xc7\xa9s\xf1\xd4\xcbb>\xda\x05\xb5\xfd\xdf=\xa3m\xcaz\xc6n\x04\x8emt\xf3\x91\x9e\xbc\xa2\xa0\xcf\x07\xb6\xb7vK$\xb5V\x9b\xb0\xa9I;\xaf\x8e\x08\xc0A\xdc\xb5\xa8\x04\x84\x15\xf8J\x89\xe4\x85\x02\xdc\xb9\xf6\xd3\xf4\xd7\x1bX\xad\xf2 \xf0m\xbd);\x882\x9d\x11s\x81\x95\x07\x06~X;\xe3\xaaz\x90z\x80\x83\x98\x03g\x92\xe8\xd1\x9f\xb7~$r\x1b\x90\xd0'
b"-\xb6\xd4Qi\xa8\xd5\x90\xa0'x\xae\x0e+\ta" b'w\xd3\xc6_\xed\x1c\xb1\xae\xb6L!d\xeb\x0b&LY\xccV\xc1#\xce\xa3\xe6\xb8\x86[5"\x97:I\xfc5z\xf2\xc1\xe9\xc8G\xb8\xb4=#N\xe0n\x9e\x99:\x1c\x818\xcf\x99\xc3`\xe5\xff[mIS\xc2'
e = 0x1001 n = 0x8700589f891e1e30bc993bc70c37fc5f50d028c4c7c5f0dd5279eb041dac70cc3e1f253dd070ce387ea49161a6726a74984ea2939599bd6ecc791c19aaeb4b9dffb1e4dc1c19e0e3729ce19e4d25c5525b9f3ee8c0107196f76005676c688297b167a2b894b812795996e4b65997fb2a48968c20ceb20b75ac760b77c79320ca1411ba00df71692bd081135fca802191c303b99a1145a4dae6516dc259c84b40ef2ca3f08a0395b166233d52a6591df1baff5f2d3a1931bdcc0616d95e89560df0d5c5ec3c8ce031b60ce98f99e27fbeb7128221cf17f43f2d0e21b8aacc03a4c0c9572b73fae33cd2fcad598307b43d86d34e642596b178772f425cbff2c22d
```

```
python3 solve.py
c b'\x1d\xf6\x1f\x85NAs\x01L\xd7\xdb\xef\xc9\xe6f\x84p-\xc7\xa9s\xf1\xd4\xcbb>\xda\x05\xb5\xfd\xdf=\xa3m\xcaz\xc6n\x04\x8emt\xf3\x91\x9e\xbc\xa2\xa0\xcf\x07\xb6\xb7vK$\xb5V\x9b\xb0\xa9I;\xaf\x8e\x08\xc0A\xdc\xb5\xa8\x04\x84\x15\xf8J\x89\xe4\x85\x02\xdc\xb9\xf6\xd3\xf4\xd7\x1bX\xad\xf2 \xf0m\xbd);\x882\x9d\x11s\x81\x95\x07\x06~X;\xe3\xaaz\x90z\x80\x83\x98\x03g\x92\xe8\xd1\x9f\xb7~$r\x1b\x90\xd0'
b'\x1d\xf6\x1f\x85NAs\x01L\xd7\xdb\xef\xc9\xe6f\x84p-\xc7\xa9s\xf1\xd4\xcbb>\xda\x05\xb5\xfd\xdf=\xa3m\xcaz\xc6n\x04\x8emt\xf3\x91\x9e\xbc\xa2\xa0\xcf\x07\xb6\xb7vK$\xb5V\x9b\xb0\xa9I;\xaf\x8e\x08\xc0A\xdc\xb5\xa8\x04\x84\x15\xf8J\x89\xe4\x85\x02\xdc\xb9\xf6\xd3\xf4\xd7\x1bX\xad\xf2 \xf0m\xbd);\x882\x9d\x11s\x81\x95\x07\x06~X;\xe3\xaaz\x90z\x80\x83\x98\x03g\x92\xe8\xd1\x9f\xb7~$r\x1b\x90\xd0'
44 b"-\xb6\xd4Qi\xa8\xd5\x90\xa0'x\xae\x0e+\ta" b'w\xd3\xc6_\xed\x1c\xb1\xae\xb6L!d\xeb\x0b&LY\xccV\xc1#\xce\xa3\xe6\xb8\x86[5"\x97:I\xfc5z\xf2\xc1\xe9\xc8G\xb8\xb4=#N\xe0n\x9e\x99:\x1c\x818\xcf\x99\xc3`\xe5\xff[mIS\xc2'
iv b"-\xb6\xd4Qi\xa8\xd5\x90\xa0'x\xae\x0e+\ta"
enc b'w\xd3\xc6_\xed\x1c\xb1\xae\xb6L!d\xeb\x0b&LY\xccV\xc1#\xce\xa3\xe6\xb8\x86[5"\x97:I\xfc5z\xf2\xc1\xe9\xc8G\xb8\xb4=#N\xe0n\x9e\x99:\x1c\x818\xcf\x99\xc3`\xe5\xff[mIS\xc2'
b'flag{ro11 your 0wn, re4p the rewards 93eecba5aa5}\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'


```

So what solve.py does is: take the first 16 bytes from se (the symmetric key), the iv, and the ciphertext, and decrypts the ciphertext with the key and iv. Wait, what?

```
se = sign(encrypt(symmetric_key, pubkey), privkey) + junk

sign(msg, privkey) = pow(msg, privkey.d, n) = decrypt(msg, privkey)
encrypt(msg, pubkey) = pow(msg, pubkey.e, n)
sign(encrypt(msg, pubkey), privkey) = decrypt(encrypt(msg, pubkey), privkey) = msg
```

As you see, sign + encrypt in RSA is indeed the identity operation.

